<!DOCTYPE html>
<html>
	<head>
		{{page "head"}}
		<script>
			$(document).ready( function () { {{range script "init-script"}} 
	{{.}} {{end}} 
{{range script "init-home-script"}} 
	{{.}} {{end}}
			} ); 
{{range script "home-script"}} 
	{{.}} {{end}}
		</script>
		{{ajax "var:newRoomName" "var:newRoomPass" "newRoomSetup" "url:home" "trigger:newRoom" "handler:newRoom" "target:roomList" "data:'newRoomName':newRoomName,'newRoomPass':newRoomPass" "newRoomSuccess"}}
	</head>
	<body>
		<div class="frame" style="position: fixed; top: 5%; height: 15%; width: 100%; z-index: 2;">
			{{page "header"}}
			{{page "banner"}}
			{{page "dashboard"}}
		</div>
		<div id="lower" class="frame">
			{{with session "item" "family"}}
				{{range .Zip }}
					<div id="local-{{ . }}" class="floatPanel local" onclick="$('.floatPanel').css('z-index','2'); $(this).css('z-index','3');" style="position:fixed;">
						<a title="Hide" class="hideModal modalButton" onclick="sidebar('local-{{ . }}');">&lt</a>
						<a class='modalButton whosHere' title='Who'>?</a>
						<a class='modalButton closeBy' title='Map' onclick="regionsNear('local-{{ . }}');">*</a>
							<h4 class='dialogHeader ptListItem'>
								<a onclick='enterRoom("{{ . }}")'>{{ . }}</a>
							</h4>
						<div class="floatFrame">
							{{ range get "childsPlay" "localPosts" . }}
								<div class="post" style="left:{{.X}}%; top:{{.Y}}%; width:{{.W}}px; height:{{.H}}px;" title="{{.Title}}">
									<img src="../img/{{.JPG}}" width="{{.W}}" height="{{.H}}" onclick="openArticle('{{.Link}}')">
								</div>
							{{ end }}
						</div>
					</div>
					<div id="local-{{ . }}-Min" class="minButton" style="display: none;">
						<a title="Hide" class="hideModal modalButton" onclick="sidebar('local-{{ . }}');">&gt</a>
						<a class='vertical' style='height: 75px;' onclick='enterRoom("{{ . }}")'>{{ . }}</a>					
					</div>
				{{end}}
			{{end}}
			<div class="panel" style="position: absolute; top: 0px;">
				<div class="row panel-body" style="height: 100%; overflow: hidden;"> 
					<div class="span4">
						<!--{{with $test := service "account" "isLoggedIn"}}
							{{if eq "True" $test}}
								Hello {{service "account" "session" "name"}}</br>
							{{end}}
						{{end}}
						<input id="newRoom-name" type="text" class="ptButton" size="24"/></br>
						<input id="newRoom-pass" type="password" class="ptButton" size="24"/></br>
						<input id="newRoom-trigger" class="ptButton" type="button" value="newRoom" />-->
					</div>
					<div class="span8">				
<!--						{{target "roomList" "<ul class='ptListItem'  style='display:none;'></ul>"}}-->
					</div>
				</div>
				</div>
			</div>
		</div>
		<div id="wallpaper">
			<svg id="mySVG" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="100%" height="100%">
				<script>
					var popSound = new Audio('/audio/bubblepop.mp3');
					function pop(cir) {
						cir.parentNode.removeChild(cir);
						popSound.play();
					}
				</script>
			</svg>
		</div>
		<div id="nav-menu">
			<svg id="menu" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="100%" height="100%">
				{{range htmls "circleMenuItem" "MODAL>>logOutModal,myProfileModal,infoModal,adminModal,loungeModal" "TX>>50,130,210,290,370,450" "FILL>>93e,3e9,9e3,e93,39e,e39"	"LABEL>>Bye-Bye,Profile,Info,Admin,Lounge" "CX>>90,170,250,330,410,490"}}
					{{.}}
				{{end}}
			</svg>
		</div>
		<div id="images">
			<svg width="100%" height="100%"></svg>
		</div>
		<div id="welcomeModal" class="modalDialog">
			<div style="text-align: center; width: 600px;">
				<a href="#closeModal" title="Close" class="closeModal modalButton">X</a>
				<h2>Who will be joining us today?</h2>
				<div class="container">
					<form id="who" action="/home" method="post">
						{{ with session "item" "family"}}
							{{range .Parent }}
								<label class="ptButton"><input type="checkbox" name="parent" value="{{index .Name 0}}">{{index .Name 0}}</label></br>
							{{end}}
							{{range .Child }}
								<label class="ptButton"><input type="checkbox" name="child" value="{{index .Name 0}}">{{index .Name 0}}</label></br>
							{{end}}
						{{end}}
						</br>
						<input type="hidden" name="postProcessingHandler" value="selectFamilyMember">
						<input type="hidden" name="redirect" value="home">
						<input type="submit" class= "ptButton" value="OK">
					</form>
				</div>
			</div>
		</div>
		<div id="myProfileModal" class="modalDialog">
			<div style="text-align: center; width: 700px;">
				<a href="#closeModal" title="Close" class="closeModal modalButton">X</a>
				<a title="Edit Mode" class="modalButton editmode" onclick="toggleEditMode('myProfileModal')">E</a>
				{{with session "item" "family"}} {{$fam := .}}
					<div id="familyProfilePic" class="pictureFrame" style="width: 320px;">
						<a title="Edit" class="modalButton edit" style="display:none;">E</a>
						{{ with index .Comments "ProfilePic" }}
							{{ $length := len . }}
							{{if not eq $length 0}}
								<a title="Comments" class="modalButton comment" style="display:none;">C</a>
							{{end}}
						{{end}}
						<img src="../img/family/{{ .ProfilePic }}" width="320" height="248" style="height:248px;">
					</div>
					<div class="personProfileInfo" style="width: 320px;">
						<h3>The {{ with index .Parent 0 }} {{ index .Name 1}} {{ end }}Family!</h3>
						<div class="frame">
							Home area codes: <a title="Add Zip" class="modalButton side" style="display:none;" onclick="configEdit('{{$fam.Login.User}}', 'addAreaCode', 'myProfileModal')">+</a>
							{{range .Zip }}<a>{{ . }}</a><a title="Remove Zip" class="modalButton side" style="display:none;" onclick="removeItem('{{$fam.Login.User}}', 'deleteAreaCode', 'myProfileModal')">-</a>
							{{ end }}
						</div>
						{{range .Parent }}
							<a href="#personModal" class="ptButton showModalTrigger" onclick="onShowProfileModal('{{$fam.Login.User}}', {{index .Name 0}}, 'myProfileModal')">{{index .Name 0}} {{index .Name 1}}</a></br>
						{{ end }}
						{{range .Child }}
							<a href="#personModal" class="ptButton showModalTrigger" onclick="onShowProfileModal('{{$fam.Login.User}}', {{index .Name 0}}, 'myProfileModal')">{{index .Name 0}} {{index .Name 1}}, {{.Sex}}, Age {{.Age}}</a></br>
						{{ end }}
					</div>
					<div class="personProfileEdit" style="width: 670px;">
						<a href="#editModal" title="Edit Family profile" class="modalButton edit" style="display:none;" onclick="configEdit('{{$fam.Login.User}}', 'familyProfile', 'myProfileModal')">E</a>
						<p>{{.Profile}}</p>
					</div>
					<div class="personProfileEdit" style="width: 670px; border: 0px;">
						<input class="ptButton" value="Manage albums" style="width: 100px;"/>
						<input class="ptButton" value="Manage family" style="width: 100px;"/>
					</div>
				{{end}}
			</div>
		</div>
		<div id="personModal" class="modalDialog">
			<div style="text-align: center; width: 600px;">
				<a href="#closeModal" title="Close" class="closeModal modalButton">X</a>
				<a title="Edit Mode" class="modalButton editmode" onclick="toggleEditMode('personModal')">E</a>
				<div id="personProfilePic" class="pictureFrame">
					<a title="Edit" class="modalButton edit">E</a>
					<img src="../img/profileBlank.jpg">
				</div>
				<div class="personProfileInfo"></div>
				<div id="personProfile" class="personProfileEdit">
					<p>Profile</p>
				</div>
				<div class="personProfileEdit" style="border: 0px;">
					<input class="ptButton" value="Edit Like/Dislikes" style="width: 100px;"/>
					<input class="ptButton" value="Edit Buzzwords" style="width: 100px;"/>
					<input class="ptButton" value="Edit Turnoffs" style="width: 100px;"/>
					<input class="ptButton" value="Manage Pictures" style="width: 100px;"/>
					<input class="ptButton" value="Manage Questions" style="width: 100px;"/>
				</div>
			</div>
		</div>
		<div id="infoModal" class="modalDialog">
			<div>
				<a href="#closeModal" title="Close" class="closeModal modalButton">X</a>
				<h2>What is {{.Title}}! all about</h2>
				<h3>The story</h3>
				<p>One day, I was pondering how shy my little boy is and how will I get him to open up to other children.  We didn't know very many families with small kids and thought about how easy it was to meet people on the internet.  I asked my wife about what she thought of a 'dating' site for babies.</p>
				<p>At first she scoffed, but in a moment the whole idea came to her as id did for me.  Of course if would be a tool for parents to set up playdates for their kids.  We could match up kids too young to make their own friends with similar developmental abilities and interest.</p>
			</div>
		</div>
		<div id="editModal" class="modalDialog">
			<div>
				<a href="#closeModal" title="Close" class="closeModal modalButton">X</a>
				<h2>Edit</h2>
			</div>
		</div>
		<div id="postModal" class="modalDialog">
			<div>
				<a href="#closeModal" title="Close" class="closeModal modalButton">X</a>
				<h2>Whats on your mind</h2>
			</div>
		</div>
		<div id="articleModal" class="modalDialog">
			<div style="text-align: center; width: 600px;">
				<a href="#closeModal" title="Close" class="closeModal modalButton">X</a>
				<div>
					<h2>Title</h2>
					<p>Author</p>
					<img>
					<p>Text</p>
				</div>
			</div>
		</div>
		<div id="logOutModal" class="modalDialog">
			<div>
				<a href="#closeModal" title="Close" class="closeModal modalButton">X</a>
				<h2>Are you sure you want to exit?</h2>
				<div class="container">
					<form action="/home" method="post">
						<input type="submit" class= "ptButton" value="Yes">
						<a href="#close" class= "ptButton">No</a>
						<input type="hidden" name="postProcessingHandler" value="logout">
						<input type="hidden" name="redirect" value="home">
					</form>
				</div>
				<p>Sorry to see you leave.</p>
				<p>Love to watch you go.</p>
			</div>
		</div>
	</body>
</html>